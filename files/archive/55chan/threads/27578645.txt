 Anões, meu pai vende pão. Tem um contrato com uma rede de padarias como fornecedor. \r\n Antes dos pães entrarem nos fornos, nós jogamos uma solução contendo leite e outros ingredientes no pão através da aspersão. Ajuda a dar uma cor e um sabor especial na casquinha do pão. A solução fica contida em um taque e é bombeada. Temos uma válvula reguladora que serve para ajustarmos a vazão ideal. \r\n \r\n O sistema funcionaria perfeitamente não fosse nossas esteiras. São caríssimas e não vale a pena trocá-las. A vazão regulada na válvula só é válida para uma velocidade constante da esteira. Se a esteira trava, tem a velocidade diminuída, ou acelerada, a vazão continua a mesma. Isso é horrível, porque os pães recebem menos solução ou mais. O final é que o pão perde as características desejadas. \r\n \r\n A rede de padarias disse que só irá renovar nosso contrato se adequarmos ao novo padrão de qualidade. Fizemos uma estimativa e somente 60% da nossa produção atual se adéqua ao futuro padrão de qualidade. \r\n \r\n Para isso teremos que desenvolver um sistema de vazão variada. Já cotamos com empresas que fornecem esse tipo de solução. É extremamente caro. Teremos que fazer isso interno. \r\n \r\n O sistema funciona assim: trocaremos a válvula reguladora manual por uma válvula de controle motorizada. Adicionaremos um sensor de velocidade na esteira e um medidor de vazão na linha de tubo do aspersor. Teremos uma placa eletrônica contendo a seguinte lógica: \r\n \r\n >entrar com setpoint D desejado (mL/pão) e a largura L da esteira \r\n >sensor de velocidade envia o valor v medido na esteira para a placa eletrônica \r\n >placa eletrônica calcula a vazão ideal através da fórmula Qi = D*L*v \r\n >placa manda a válvula de controle abrir de tal maneira a permitir a vazão ideal Qi (é como se fosse uma torneira, abre mais sai mais água, fecha sai menos) \r\n >medidor de vazão vai ler qual a vazão real Qr e enviará para a placa \r\n >placa eletrônica comparará a leitura do sensor com o setpoint, se Qr > Qi fechar a válvula para ajustar Qr = Qi, se Qr < Qi abrir a válvula para ajustar Qr = Qi \r\n \r\n Assim eu garantiria que se houver variação na velocidade da esteira, a vazão será ajustada de tal forma a manter a vazão ideal. Perguntas no próximo post.
 Pergunto aos anões como tornar essa lógica realidade? \r\n \r\n Qual placa utilizar? Há como modelar esse problema computacionalmente? Onde conseguir catálogos de componentes para tirar informações e colocar no modelo? \r\n \r\n Como faço para ajustar os parâmetros e ver como será a resposta? Explico: tenho que fazer que a correção na válvula de controle seja tão rápida quanto maior for o erro. Se a vazão tiver muito errado, a válvula tem que fechar rapidamente. Se o erro for menor, a válvula deve fechar mais devagarzinho. \r\n \r\n Enfim, como vocês me aconselhariam a transformar essa ideia em realidade? \r\n \r\n Fiz técnico em informática. Aprendi a programar um pouco. Sou fuçado e consigo desenrolar isso. Tenho até o Janeiro para dar um fim nisso. \r\n \r\n Obrigado pela ajuda. Anão é irmão!
 bump
 M-mas eu só quero comprar pão.
 >>27578747 \r\n \r\n Prover pão não é coisa fácil, anão.
 >>27578749 \r\n D-dois pães, por favor.
 >>27578758 \r\n Ajude-me a fazê-los e terei o prazer de dá-los a ti.
 Uma placa Arduino Uno tem poder para fazer isso. \r\n \r\n Você pode ir nas universidades com cursos de engenharia elétrica, automação ou eletrônica da sua região, estudantes perto do final de curso podem fazer isso cobrando muito pouco. \r\n \r\n Mas se você quiser fazer você mesmo, gastará um tempo aprendendo a lidar com o arduino e os componentes, mas se for persistente pode ser que consiga sozinho.
 >>27578678 \r\n Você poderia usar o Proteus ou algum software do tipo para modelar o circuito. Se não me engano, o programa permite você colocar um microcontrolador atmega e carregar o código que iria no Arduíno. \r\n \r\n >tenho que fazer que a correção na válvula de controle seja tão rápida quanto maior for o erro \r\n \r\n Isso é um problema típico de controle. Pode usar um controlador PID. Pica relatada, dá para ser implementado em software. Os parâmetros você deriva empiricamente.
 >>27578798 \r\n \r\n Poderia me falar um pouco de como derivar empiricamente os parâmetros?
 >>27578833 \r\n É um assunto meio complicado de explicar, anão. Já que você precisa entender a influência de cada um desses componentes na resposta final. Então recomendo primeiramente entender cada fator. Sei que existem até heurísticas que tentam otimizar isso automaticamente, mas não sou especialista nisso.
 >>27578877 \r\n \r\n Quão difícil você diria que é transformar esse projeto em realidade, anão? \r\n \r\n Você é engenheiro de controle? \r\n \r\n Acha que Matlab vai me ajudar em alguma coisa? Estava pesquisando aqui o PID.
 >>27578896 \r\n >Quão difícil você diria que é transformar esse projeto em realidade, anão? \r\n \r\n Não parece muito difícil, mas colocar essas coisas para funcionar é sempre trabalhoso. \r\n \r\n >Você é engenheiro de controle? \r\n \r\n Computação. Controle não foi muito o meu foco, mas eu ainda sei um pouco. \r\n \r\n >Acha que Matlab vai me ajudar em alguma coisa? \r\n \r\n Matlab tem uma toolbox de sistema de controles. Pode ajudar bastante. Eu não sei qual será a dificuldade para aprender a usar.
 >>27578922 \r\n \r\n Anão, o que seria a 'planta' no meu problema?
 >>27578934 \r\n O que você controla fisicamente. No caso ali, seria a válvula da bomba.
 >>27578957 \r\n \r\n E como faço para encontrar a equação dela?
 Conhece Labview?
 >>27578976 \r\n É parecido com MATLAB?
 >>27578981 \r\n Muito mais fácil, e as soluções de PID são bem simples de se implementar
 >>27578986 \r\n http://www.ni.com/tutorial/6440/en/ 
 >>27578965 \r\n O controlador é a equação. Você precisa 'tunar' os coeficientes de cada componente para que ele diminua o erro de uma forma otimizada. Ele faz exatamente o que disse: \r\n \r\n >placa eletrônica comparará a leitura do sensor com o setpoint, se Qr > Qi fechar a válvula para ajustar Qr = Qi, se Qr < Qi abrir a válvula para ajustar Qr = Qi \r\n \r\n E o erro vai diminuindo parecido com o gráfico relatado.
 >>27578986 \r\n Como ele eu não preciso programar? \r\n \r\n Dá para carregar no Arduino?
 >>27578999 \r\n O erro no caso é o seu input - o que está sendo lido no medidor da vazão.
 >>27579000 \r\n A programação é bem simples e gráfica… \r\n E também da pra jogar o programa no arduino.
 O-onde os anãos aprenderam tudo isso?
 >>27579003 \r\n \r\n Entendi. \r\n \r\n Você disse que a válvula de regulagem da vazão é minha planta. Ela será minha planta. Ela é o que eu vou controlar. \r\n \r\n Mas como ela funciona? \r\n \r\n Eu sei que ela tem um motor e um redutor. Ela vai fechando um orifício conforme o motor roda. O fechamento do orifício é o que restringe o escoamento na linha. \r\n \r\n Ela tem três parênquima paliçádicos. Dois são de alimentação (12 V, positivo e negativo). Será alimentado por uma fonte externa. \r\n \r\n O terceiro parênquima paliçádico é o que eu tenho que ligar na placa de controle (pelo que pesquisei o mais fácil é eu utilizar o Arduino). \r\n \r\n Como eu vou lidar com esse terceiro parênquima paliçádico na placa? O que ele significa? O que a placa envia nesse parênquima paliçádico para a válvula? É uma tensão? \r\n \r\n Se for uma tensão, então há uma equivalência entre o sinal de tensão enviado pela placa e a posição do motor? \r\n \r\n Entendeu meu ponto, anão?
 >>27579032 \r\n É uma entrada de sinal analógico, vc manda de 4 a 20mA e (minimo e máximo)
 >>27579043 \r\n Entendi. Eu envio essa faixa de corrente para a válvula pelo parênquima paliçádico do Arduino. Assim o motor da válvula tem uma rotação tão mais alta quanto maior for esse sinal analógico enviado?
 >>27579032 \r\n Teria alguma informação dessa válvula para pesquisar? Se for realmente necessário um sinal analógico, você precisa mais do que um desses arduínos comuns.
 >>27579031 \r\n Universidade e estudando por conta (sempre).
 >>27579058 \r\n Essa é a válvula que a empresa que faria nosso projeto iria usar.
 >>27579054 \r\n Depende o motor que você tem… Existem quase infinitas combinações de fazer isso funcionar. \r\n \r\n - Seu motor por ter abertura variável deve ter um drive, ( controla a velocidade e direção ) \r\n Se você souber qual o driver e motor fica mais fácil te dar o caminho.
 >>27579065 
 >>27579069 \r\n Tentarei descobrir. \r\n \r\n >>27579058 \r\n O que vai além dos Arduinos comuns? Eu teria que partir para qual lado?
 >>27579087 \r\n Da pra usar arduino comum sim, ele tem uma porta PWM…
 >>27579087 \r\n >O que vai além dos Arduinos comuns? Eu teria que partir para qual lado? \r\n \r\n Eu não consigo achar a especificação do que vai no terceiro parênquima paliçádico que você disse, o necessário para controlar a válvula. A questão é o seguinte, os arduínos comuns tem saídas digitais nos seus pinos, então muitas vezes as coisas são controladas por PWM. Se isso realmente não for o caso dessa válvula, algo difícil que eu queria verificar, você precisaria de algo que gerasse uma tensão analógica.
 >>27579095 \r\n >>27579098 \r\n Complementando, se ficar confirmado que é por PWM, o que é o mais provável, é fácil fazer isso em qualquer arduíno.
 >>27579103 \r\n \r\n Anão, estou verificando se acho algo nos catálogos. Você ficará por este recinto até que horas?
 >>27579107 \r\n Estou consumindo álcool, portanto até quando não conseguir beber mais.
 >>27579107 \r\n \r\n Esse é o comando de válvulas que utilizarei. \r\n \r\n Ele tem 3 válvulas de seção, que são do tipo aberto ou fechado. Ela corta a vazão na fileira quando for necessário. \r\n \r\n Tem um marmelo de líquido e um fluxômetro. Esse será o fluxômetro que utilizarei no Arduino para ler as vazões. \r\n \r\n A válvula circulada é a que permite ou restringe o fluxo.
 Porra, anão! Você tá complicando, aproveita que engenheiro não tá conseguindo emprego e contrata um pra ficar com um borrifador do lado da esteira. Pronto, resolvi seu problema.
 \r\n >>27579121 \r\n \r\n Anão, temos 9 esteiras. São mais de 3.000 pães produzidos por dia. É inviável contratar engenheiros borrifadores.
 >>27579114 \r\n Está aí, anão? \r\n \r\n Essa é uma imagem em corte da válvula e aparece o motor.
 OP, você já foi atrás do SENAI? Com certeza poderão fornecer a solução por um preço muito mais em conta que uma empresa privada. \r\n Outra pergunta: você é um Professor Pardal ou é a primeira vez que vai fazer algum projeto do tipo? Se for a primeira vez e o prazo for muito curto, aí fica difícil. O SENAI vai ser sua melhor opção.
 >>27579175 \r\n Sim, a única coisa importante é saber se é controlado por PWM (o mais provável). Se a resposta é sim, acabou o problema. Você faz isso de maneira simples com qualquer arduino.
 >>27579175 \r\n Vazão máxima permitida em função da % do curso do bloqueio do orifício.
 >>27579177 \r\n Anão, não tenho escolha. Tenho que me virar para fazer isso. Tenho até Janeiro, então estou meio tranquilo.
 >>27579183 \r\n Se não for PWM é o quê? E quais seriam as possíveis soluções? \r\n \r\n Deus te abençoe, anão!
 >>27579202 \r\n Driver, inversor ….
 >>27579190 \r\n Sou engenheiro mecânico mas não tenho muito o que acrescentar ao parênquima paliçádico, por enquanto. \r\n Na verdade, eu já trabalhei um pouco com eletrônica e, como o alguém já disse aqui, vai dar trabalho pra fazer funcionar. Se prepare. Pelo menos você tem mais que um semestre. \r\n Já tem o Arduino? Compre logo. Quanto antes, melhor. \r\n \r\n >>27579202 \r\n Pode ser um motor DC.
 >>27579202 \r\n Isso é questão de protocolo de comunicação. PWM é uma das formas mais simples de 'emular' um sinal analógico (usado em servos motores, por exemplo), em vez da tensão mudar analogicamente, ele muda o período (tempo) e a tensão fica digital (Máximo ou mínimo). Entretanto, existem protocolos de comunicação mais sofisticados, por exemplo, UART e SPI (também digitais).
 >>27579218 \r\n Complementando, esses 3 protocolos digitais são fáceis de implementar no arduíno. Possuem bibliotecas prontas. A única questão é saber qual é a interface da válvula.
 Anão, dê uma olhada nessa imagem. \r\n \r\n Peguei do catálogo agrícola, mas é exatamente a mesma válvula usada na parte de alimentação industrial. \r\n \r\n >motores de 1, 3 e 6 rpm \r\n >consumo de 1 A \r\n >dois parênquima paliçádicos as VDC \r\n \r\n Eu achei que tivesse três parênquima paliçádicos essa válvula, mas são somente dois. Como é feito nesse caso a comunicação com o Arduino?
 >>27579233 
 >>27579233 \r\n Deve ser um motor DC: se liga, ele começa a girar e só para quando desligar.
 >>27579240 \r\n \r\n Eu consigo entregar os 12 volts ligando ele no Arduino?
 >>27579241 \r\n Só pra constar, sou o engenheiro mecânico, não o outro anão que já estava aqui. \r\n Não consegue. Se não me engano, o Arduino entrega 5,5V apenas. Além disso, não seria boa prática fazer a alimentação da válvula sair do Arduino. Você tem que separar a parte de controle da parte de força. Se a força der problema, você tem chance de salvar o controle e não perder tudo.
 >>27579246 \r\n \r\n Vixi, anão. Então como lidar com o controle da válvula sabendo que ela só tem 2 parênquima paliçádicos?
 >>27579246 \r\n Esse anão tem razão. Você pode vai precisar de uma alimentação de 12V, mas o arduino tem um regulador para 5V. Pesquise um IC 'level shifter
 >>27579253 \r\n >…'level shifter' que te dará 12 V e ainda acho que terão diodos para prevenir qualquer dano caso tenha uma corrente reversa da válvula. \r\n \r\n Fixado.
 Anão, tudo que você sabe dessa válvula é pesquisando? Essa pica >>27579233 deu a impressão que o controle é feito manualmente por esse botão vermelho. Sendo que a outra pica fala que o controle é simplesmente ligar/desligar.
 >>27579250 \r\n Depende de como ela funciona. Você tem que descobrir. Se for isso mesmo, você também vai precisar de um sensor pra saber se ela chegou no lugar certo.
 >>27579268 \r\n \r\n Anão, as válvulas de corte de seção são Ligar/Desligar. \r\n \r\n A Válvula de Regulagem, não. Ela tem o curso ajustável automaticamente. Não há necessidade de apertar botão algum. \r\n \r\n Veja esse gráfico, ele traz a %vazão em função da abertura da válvula. >>27579184 
 Anão manjador, se possível de uma olhada nesse vídeo. É o mesmo raciocínio. \r\n \r\n As válvulas são as mesmas. São utilizadas tanto em pulverização agrícola quanto industrial. Neste do vídeo é uma aplicação agrícola. \r\n \r\n Ele tem um sensor de roda, no meu caso seria uma sensor de esteira. \r\n \r\n Por favor, veja a explicação.
 >>27579285 \r\n \r\n Essa caixinha que ele mostra é a que eu tenho que fazer!
 >>27579285 \r\n \r\n Ele explica certinho: os dados obtidos no sensor de velocidade e no fluxômetro são lidos pela caixinha (controlador). O sinal atua sobre a Válvula Reguladora. \r\n \r\n O sistema desse cara custa 3k mais 1k para instalação. Preciso de nove. Isso custaria 36k! Impossível para nós.
 >>27579296 \r\n \r\n Agora como o controlador atua sobre a Válvula Reguladora? Isso eu ainda não consegui entender!
 >>27579299 \r\n To assistindo, cacete. Calma.
 >>27579302 \r\n Kek, não fui eu quem disse isso.
 >>27579285 \r\n \r\n >dê \r\n \r\n Fixado.
 Não vou quotar, só comentar. Sou o engenheiro. \r\n Rapaz… você tá focado de mais na vávula. Esse projeto vai dar muito mais trabalho que só controlar a válvula. Meu tempo vai se esgotar, preciso dormir, mas vou tentar desenhar. Volto já. Ou não 
 >>27579296 \r\n \r\n >Ele explica certinho: os dados obtidos no sensor de velocidade e no fluxômetro são lidos pela caixinha (controlador). O sinal atua sobre a Válvula Reguladora. \r\n \r\n Sim, isso já foi discutido. Eu estou vendo o vídeo, anão, e ainda fica a dúvida sobre o que estávamos discutindo. A interface (protocolo de comunicação) para leitura e entrada da válvula. O fornicação que não estou achando isso. Essa seria a parte fácil, junto com calcular a velocidade. Depois de conseguir esses dados é que deveria implementar o PID no arduíno.
 Um esqueminha de pulverização agrícola. Gostaria de encontrar um de aspersão industrial, mas não acho. Mas enfim, é a mesma coisa, só muda os materiais. Industrial tem mais inox etc.
 >>27579314 \r\n Anão, se esses caras fizeram, eu faço! Hoje é o primeiro dia que peguei para focar nisso. Quando vi que o orçamento mais barato para implementar isso na fábrica ia ficar 40 mil talqueis, eu criei coragem e força de vontade. Also, tenho do meu lado a elite intelectual do país!
 >>27579327 \r\n Qual a sua escolaridade?
 >>27579338 \r\n Sou formado em Administração. Mas sou fuçado, anão! \r\n \r\n Reitero, eu consigo me virar. Vida de fábrica não é fácil. Todo dia arrumando pepino.
 >>27579344 \r\n Ainda está aí?
 >>27579362 \r\n Sim. Qualquer orientação é bem vinda, anão.
 >>27579363 \r\n Terminei o desenho. Tive que cagar. Aguarde.
 >>27579371 \r\n \r\n Muito obrigado, anão. Espero que tenha tido uma cagada agradável. No aguardo.
 Mandei do esperto fone. Explico num quote.
 Não use o Arduino. Quase sempre ele queima depois de 3, 4 meses funcionando 24/7. Use um PIC ou um 8051 parrudo.
 >>27579383 \r\n \r\n Anotado, anão.
 >>27579381 \r\n \r\n Ótimo fluxograma, anão. Mais uma vez agradeço a bondade e atenção. Vou trabalhar em cima disso a partir de hoje.
 >>27579393 \r\n Espera aí, cacete. To escrevendo uma parede de texto pra explicar ele. Não some ainda, viado.
 >>27579396 \r\n Não sairei.
 >>27579381 \r\n Como algum anão já disse, muitas válvulas podem se encaixar nesse projeto. Escolha uma que seja barata pra você testar, depois compre uma mais cara que mais confiável mas que tenha as mesmas características que a mais barata. Ou compre logo uma cara e fique com ela até o fim, porque o projeto todo vai depender dela. \r\n Se fosse um projeto de mais de uma pessoa, seria mais fácil trocar depois, mas por ora, recomendo você a ter uma só em mente. Ou pelo menos ter uma só enquanto faz um protótipo. Depois que ver que conseguiu entender como fazer o sistema, se mudar a válvula, muda pouca coisa no resto. \r\n \r\n Vamos à imagem. Observe os astericos, \r\n \r\n >(*) \r\n Você disse que já usam um sistema pra aspersão da cobertura nos pães. Agora você tem que anotar qual velocidade é pra qual vazão, se é que já não tem isso anotado. Se já tiver, melhor ainda. Pois jogue no Excel, faça uma regressão linear (ou outra função apropriada) e obtenha a equação que relaciona velocidade da esteira com a vazão. Tendo feito administração, acho que você deve saber fazer pelo menos isso. Se não souber, pelo menos sabe usar o Excel e sabe onde achar as coisas. Procure por 'regressão linear', 'equação da reta', 'aproximar gráfico', sei lá. \r\n \r\n >(**) \r\n A equação da válvula é mais complicada. Você pode extrair ela do próprio gráfico que você colocou aqui, mas é melhor testar uma válvula real. Faça o mesmo que fizer para obter a equação 'velocidade vs. vazão'. \r\n \r\n >O 'cérebro' do controle são as duas caixinhas 'decidir se age' e 'converter posição pra sinal adequado' \r\n 'Decidir se age' quer dizer saber se a válvula já está em posição máxima ou mínima, por exemplo. Saber se está no limite, saber se tem algum erro. Se estiver no máximo e precisar de mais abertura, ela tem que decidir não abrir mais, porque é impossível. Entende? Pode também ser algo mais complexo, mas que não quero pensar agora nem tentar entrar em detalhes. \r\n \r\n 'Converter para um sinal adequado' é o que outro anão falou. Dependendo da válvula, ela vai ter que ser contralada do jeito certo. Então, primeiro, você decide a válvula e descobre como ela pode ser controlada. Depois disso, você vai precisar de outra equação que converta 'posição desejada' em 'sinal de válvula', se é que me entende, um sinal que signifique que a válvula vai pra posição desejada. Se a válvula for só liga e desliga como eu disse em >>27579270 aí fica mais difícil, porque o 'sinal adequado' vai ser 'ligar' ou 'parar' e você vai ter que observar quantos graus ela girou pra saber se chegou na posição adequada. Daí o diagrama fica um pouco diferente desse aí, mas você, esperto que é, vai conseguir achar uma solução pra isso. \r\n \r\n Ali nas partes onde está 'algum valor numérico', vai depender da equação que você vai achar. Pode ser só \r\n 'posição da desejada - posição atual' (uma subtração) ou algo mais complexo. Comece pela subtração.
 >>27579402 \r\n É isso. Agora vou-me. Se algum dia eu vir este parênquima paliçádico de novo, checarei seu progresso.
 >>27579409 \r\n Vai com Deus.
